% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pq_last_modified.R
\name{pq_last_modified}
\alias{pq_last_modified}
\title{Get last-modified metadata for Parquet data files}
\usage{
pq_last_modified(
  table_name = NULL,
  schema = NULL,
  data_dir = Sys.getenv("DATA_DIR", "."),
  archive = FALSE,
  archive_dir = "archive"
)
}
\arguments{
\item{table_name}{Optional. Name of a specific table.}

\item{schema}{Optional. Name of the schema (subdirectory under
\code{data_dir}).}

\item{data_dir}{Root directory of the Parquet data repository. Defaults to
the \code{DATA_DIR} environment variable, or \code{"."} if unset.}

\item{archive}{If \code{TRUE}, look in the archive subdirectory instead of
the main schema directory.}

\item{archive_dir}{Name of the archive subdirectory. Defaults to
\code{"archive"}.}
}
\value{
When \code{table_name} is provided and \code{archive = FALSE}, a
single string. Otherwise a \link[tibble]{tibble} with columns
\code{file_name}, \code{table}, \code{schema}, \code{last_mod} (a
\code{POSIXct} in UTC), and \code{last_mod_str}.
}
\description{
Retrieves the \code{last_modified} metadata embedded in Parquet files by
\code{\link{wrds_update_pq}}.
}
\details{
Behaviour depends on the arguments supplied:

\itemize{
\item \strong{\code{table_name} provided, \code{archive = FALSE}} (default):
Returns the raw \code{last_modified} string embedded in
\code{<data_dir>/<schema>/<table_name>.parquet}, or \code{""} if the
file has no such metadata.
\item \strong{\code{table_name} provided, \code{archive = TRUE}}:
Returns a data frame of all archived files matching \code{table_name}
in \code{<data_dir>/<schema>/<archive_dir>/}.
\item \strong{Only \code{schema} provided (no \code{table_name})}:
Returns a data frame summarising all Parquet files in the schema
directory (or its archive subdirectory if \code{archive = TRUE}).
\item \strong{Neither \code{table_name} nor \code{schema} provided}:
Returns a data frame summarising all Parquet files across every schema
subdirectory of \code{data_dir}.
}
}
\examples{
\dontrun{
# Raw metadata string for a single table
pq_last_modified("dsi", "crsp")

# Summary of archived versions of a table
pq_last_modified("company", "comp", archive = TRUE)

# Summary of all tables in a schema
pq_last_modified(schema = "crsp")

# Summary of all tables across all schemas
pq_last_modified(data_dir = "data")
}

}
\seealso{
\code{\link{wrds_update_pq}}
}
